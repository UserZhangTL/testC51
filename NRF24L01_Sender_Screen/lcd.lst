C51 COMPILER V9.51   LCD                                                                   01/16/2016 14:46:09 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN lcd.obj
COMPILER INVOKED BY: D:\360Downloads\C51\BIN\C51.EXE lcd\lcd.c BROWSE INCDIR(.\delay;.\lcd;.\uart;.\NRF24L01__Sender;.\k
                    -eyboard_v;.\LCD12864) DEBUG OBJECTEXTEND PRINT(.\lcd.lst) TABS(2) OBJECT(lcd.obj)

line level    source

   1          #include "AllFunc.h"
   2          
   3          
   4          sbit RS = P2^4;
   5          sbit RW = P2^5;
   6          sbit E = P2^6;
   7          
   8          #define DataPort P0
   9          
  10          void lcd_clean()
  11          {
  12   1          lcd_write_cmd(0x01);
  13   1          delay_ms(15);
  14   1      }
  15          
  16          
  17          void lcd_write_cmd(unsigned char byte)
  18          {
  19   1          //命令
  20   1          RS = 0;
  21   1          //写有效
  22   1          RW = 0;
  23   1          //使能有效
  24   1          E = 1;
  25   1          //命令内容
  26   1          DataPort = byte;
  27   1          //延时，等待命令输入成功
  28   1          _nop_();
  29   1          _nop_();
  30   1          //关闭使能
  31   1          E = 0;
  32   1      }
  33          
  34          void lcd_write_data(unsigned char byte)
  35          {
  36   1          //数据
  37   1          RS = 1;
  38   1          //写
  39   1          RW = 0;
  40   1          E = 1;
  41   1          DataPort = byte;
  42   1          _nop_();
  43   1          _nop_();
  44   1          delay_us(10);//芯片要求延时时间长一点
  45   1          E = 0;
  46   1      }
  47          
  48          void lcd_init()
  49          {
  50   1          /*具体见使用手册，长沙太阳那个*/
  51   1          delay_ms(15);
  52   1          /*做三遍，为了确保成功*/
  53   1          lcd_write_cmd(0x38);//设置显示模式
  54   1          delay_ms(5);
C51 COMPILER V9.51   LCD                                                                   01/16/2016 14:46:09 PAGE 2   

  55   1          lcd_write_cmd(0x38);
  56   1          delay_ms(5);
  57   1          lcd_write_cmd(0x38);
  58   1          delay_ms(5);
  59   1        
  60   1          
  61   1          lcd_write_cmd(0x08);//显示关闭
  62   1          delay_ms(2);
  63   1          lcd_write_cmd(0x01);//清屏
  64   1          delay_ms(2);
  65   1          lcd_write_cmd(0x06);//光标关
  66   1          delay_ms(2);
  67   1          lcd_write_cmd(0x0c);//显示开
  68   1          
  69   1      }
  70          
  71          //写入一个字符，在（x，Y）位置，写入byte
  72          void lcd_write_char(unsigned char x,unsigned char y,unsigned char byte)
  73          {
  74   1          //第一行
  75   1          if(0 == y)
  76   1          {
  77   2              lcd_write_cmd(0x80 + x);
  78   2          }
  79   1          //第二行
  80   1          else if(1 == y)
  81   1          {
  82   2              lcd_write_cmd(0x80 + 0x40 + x);
  83   2          }
  84   1          
  85   1          lcd_write_data(byte);
  86   1      }
  87          
  88          
  89          //打印一个字符串，第一个字符在x，y处
  90          void lcd_write_str(unsigned char x,unsigned char y,unsigned char *s)
  91          {
  92   1          if(0 == y)
  93   1          {
  94   2              lcd_write_cmd(0x80 + x);
  95   2          }
  96   1          else if(1 == y)
  97   1          {
  98   2              lcd_write_cmd(0x80 + 0x40 + x);
  99   2          }
 100   1          
 101   1          //当还未到'\0'时，循环打印，光标会自动往后移动，所以不需要手动
 102   1          while(*s)
 103   1          {
 104   2              lcd_write_data(*s);
 105   2              s ++;
 106   2          }
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    192    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.51   LCD                                                                   01/16/2016 14:46:09 PAGE 3   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
